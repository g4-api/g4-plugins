# Page Source (PageSource)

[Table of Content](../Home.md)  

~14 min · ExtractionScope Plugin · [Roei Sabag](https://www.linkedin.com/in/roei-sabag-247aa18/)

## Description

> [!IMPORTANT]  
> This scope creates an internal DOM object and only supports XPath expressions.

### Purpose

The `PageSource` extraction scope is designed for web scraping tasks focused on collecting data from the static HTML content of a web page, exactly as it is received when a GET request is made to the web server. 
It ensures that the extracted data represents the web page's original HTML structure, excluding any dynamic or client-side generated content, such as updates triggered by JavaScript or AJAX.

### Key Features and Functionality

| Feature                      | Description                                                                                                             |
|------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| Static Content Extraction    | Captures data from the web page's initial, unchanging content, including plain text, images, links, and other elements. |
| Excludes Dynamic Content     | Focuses on the core HTML structure, excluding content generated by client-side scripting after the initial page load.   |
| Ideal for Standard Web Pages | Suitable for websites with straightforward HTML structures and minimal client-side scripting.                           |
| XPath-Based Data Collection  | Utilizes XPath expressions to pinpoint and extract specific elements within the static HTML.                            |
| Stability and Predictability | Ensures consistent extraction of data from stable HTML structures, ideal for repeated or scheduled tasks.               |

### Usages in RPA

| Usage                     | Description                                                                                        |
|---------------------------|----------------------------------------------------------------------------------------------------|
| Static Content Extraction | Used to collect data from web pages where the content does not change after the initial page load. |
| Automated Reporting       | Ideal for aggregating and analyzing data from multiple web pages in their original HTML form.      |
| Monitoring and Analysis   | Suitable for monitoring changes in static content over time, ensuring accurate data collection.    |

### Usages in Automation Testing

| Usage                     | Description                                                                                                               |
|---------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Page State Validation     | Validates the original HTML structure of a web page in end-to-end tests, ensuring content is as expected.                 |
| Regression Testing        | Helps in regression testing by capturing the HTML body content before and after changes to detect unintended alterations. |
| Stability and Consistency | Ensures that static content remains consistent across different test environments and test runs.                          |

### See Also

- [HTML Agility Pack Documentation](https://html-agility-pack.net/)
- [HTML Agility Pack GitHub Repository](https://github.com/zzzprojects/html-agility-pack)

## Examples

### Example No.1

Extract the text associated with the `Location` label from the `ExportData.html` web page. 
This example demonstrates how to call the `PageSource` plugin directly, specifying the `onElement`, `contentRules`, and `dataCollector` properties. 
The `Location` text within a `div` element with the class `hotel` is located, a regular expression is applied to capture the text following the label, and the extracted data is stored in JSON format in the `DataFile.json` file.

_**CSharp**_

```csharp
var actionRule = new ActionRuleModel
{
    PluginName = "PageSource",
    OnElement = "//div[@class='hotel']"
};
```

_**Java**_

```java
ActionRuleModel actionRule = new ActionRuleModel()
    .setPluginName("PageSource")
    .setOnElement("//div[@class='hotel']");
```

_**Javascript**_

```js
var actionRule = {
    pluginName: "PageSource",
    onElement: "//div[@class='hotel']"
};
```

_**JSON**_

```js
{
    "pluginName": "PageSource",
    "onElement": "//div[@class='hotel']"
}
```

_**Python**_

```python
action_rule = {
    "pluginName": "PageSource",
    "onElement": "//div[@class='hotel']"
}
```
### Example No.2

Extract the text associated with the `Location` label from the `ExportData.html` web page as part of an extraction rule within an automation request. 
This example shows how to use the `PageSource` plugin within an extraction rule setup. 
It locates the `Location` text within a `div` element with the class `hotel`, applies a regular expression to capture the text following the label, and stores the extracted data in JSON format in the `DataFile.json` file.

_**CSharp**_

```csharp
var actionRule = new ActionRuleModel
{
    PluginName = "",
    OnElement = "//div[@class='hotel']"
};
```

_**Java**_

```java
ActionRuleModel actionRule = new ActionRuleModel()
    .setPluginName("")
    .setOnElement("//div[@class='hotel']");
```

_**Javascript**_

```js
var actionRule = {
    pluginName: "",
    onElement: "//div[@class='hotel']"
};
```

_**JSON**_

```js
{
    "pluginName": "",
    "onElement": "//div[@class='hotel']"
}
```

_**Python**_

```python
action_rule = {
    "pluginName": "",
    "onElement": "//div[@class='hotel']"
}
```

## Properties

### On Element (OnElement)

| Attribute         | Value             |
|-------------------|-------------------|
| **Default Value** | Null              |
| **Depends On**    | None              |
| **Mandatory**     | Yes               |
| **Multiple**      | No                |
| **Value Type**    | String|Expression |

Specifies the target element within the static HTML from which data is to be extracted. This is typically defined using an XPath expression.

### Locator (Locator)

| Attribute         | Value             |
|-------------------|-------------------|
| **Default Value** | Xpath             |
| **Depends On**    | None              |
| **Mandatory**     | No                |
| **Multiple**      | No                |
| **Value Type**    | String            |

Specifies the locator strategy used to identify the target elements within the static HTML. The default value is 'Xpath'.

### Rules (Rules)

| Attribute         | Value             |
|-------------------|-------------------|
| **Default Value** | Null              |
| **Depends On**    | None              |
| **Mandatory**     | Yes               |
| **Multiple**      | No                |
| **Value Type**    | Object            |

Defines the rules for extracting content from the specified element, such as applying regular expressions or trimming the extracted data.

### Data Collector (DataCollector)

| Attribute         | Value             |
|-------------------|-------------------|
| **Default Value** | Null              |
| **Depends On**    | None              |
| **Mandatory**     | No                |
| **Multiple**      | No                |
| **Value Type**    | Object            |

Specifies how the extracted data will be collected and stored, such as saving it in JSON format or another supported format.

### Regular Expression (RegularExpression)

| Attribute         | Value             |
|-------------------|-------------------|
| **Default Value** | (?s).*            |
| **Depends On**    | None              |
| **Mandatory**     | No                |
| **Multiple**      | No                |
| **Value Type**    | Regex             |

Specifies a regular expression to be applied to the extracted content before it is processed. 
This allows for more flexible validation and extraction of text that may require pattern matching.

## Scope

* Mobile Web
* Web
## See Also

apiDocumentation: [https://html-agility-pack.net/documentation](https://html-agility-pack.net/documentation)
